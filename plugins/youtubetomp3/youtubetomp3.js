(function(s,r){typeof exports=="object"&&typeof module<"u"?module.exports=r(require("lucide-react"),require("react"),require("sonner")):typeof define=="function"&&define.amd?define(["lucide-react","react","sonner"],r):(s=typeof globalThis<"u"?globalThis:s||self,s.youtubetomp3=r(s.LucideReact,s.React,s.Sonner))})(this,(function(s,r,f){"use strict";var N={exports:{}},b={};var P;function C(){if(P)return b;P=1;var i=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function d(y,n,a){var u=null;if(a!==void 0&&(u=""+a),n.key!==void 0&&(u=""+n.key),"key"in n){a={};for(var c in n)c!=="key"&&(a[c]=n[c])}else a=n;return n=a.ref,{$$typeof:i,type:y,key:u,ref:n!==void 0?n:null,props:a}}return b.Fragment=t,b.jsx=d,b.jsxs=d,b}var k;function M(){return k||(k=1,N.exports=C()),N.exports}var e=M();const T=r.createContext(void 0);function D({children:i}){const[t,d]=r.useState(!1),[y,n]=r.useState({percent:0}),[a,u]=r.useState(null),c=r.useCallback(async(w,v,p)=>{d(!0),u(p),n({percent:0});let m;try{m=window.electronAPI.youtube.onDownloadProgress(x=>{n(x)});const l=await window.electronAPI.youtube.download(w,v);if(l&&!l.success)throw new Error(l.error||"Download failed");f.toast.success("Téléchargement terminé !");try{await window.electronAPI.notify("Téléchargement terminé",`${p.title} a été téléchargé avec succès.`)}catch(x){console.error("Erreur notification",x)}n({percent:100}),setTimeout(()=>{d(!1),n({percent:0}),u(null)},3e3)}catch(l){if(console.error(l),l.message&&l.message.includes("annulé"))f.toast.info("Téléchargement annulé");else{f.toast.error("Erreur lors du téléchargement : "+l.message);try{await window.electronAPI.notify("Erreur de téléchargement",l.message||"Une erreur est survenue")}catch(x){console.error(x)}}d(!1)}finally{m&&m()}},[]),j=r.useCallback(async()=>{console.log("Cancelling download...");try{await window.electronAPI.youtube.cancel(),console.log("Cancellation request sent")}catch(w){console.error("Erreur lors de l'annulation",w)}},[]);return e.jsx(T.Provider,{value:{isDownloading:t,progress:y,videoInfo:a,startDownload:c,cancelDownload:j},children:i})}function S(){const i=r.useContext(T);if(i===void 0)throw new Error("useDownload must be used within a DownloadProvider");return i}function E(){const{isDownloading:i,progress:t,videoInfo:d,startDownload:y,cancelDownload:n}=S(),[a,u]=r.useState(""),[c,j]=r.useState(!1),[w,v]=r.useState(null),[p,m]=r.useState("Vérification des composants..."),[l,x]=r.useState("mp3"),[I,Y]=r.useState("best"),o=i&&d?d:w;r.useEffect(()=>{(async()=>{try{const h=window.electronAPI.youtube.onBinaryProgress(F=>{m(F)});await window.electronAPI.youtube.checkBinaries();const $=await window.electronAPI.youtube.getBinariesPath();console.log("Binaries path:",$),m(null),h()}catch(h){console.error(h),m("Erreur lors du chargement des composants."),f.toast.error("Impossible de charger les composants nécessaires.")}})()},[]);const V=async g=>{if(g.preventDefault(),!!a.trim()){j(!0),v(null);try{const h=await window.electronAPI.youtube.getInfo(a);v(h)}catch(h){console.error(h),f.toast.error("Impossible de récupérer les infos de la vidéo.")}finally{j(!1)}}},q=async()=>{o&&(i||await y(a,{format:l,quality:I},o))},L=()=>{window.electronAPI.youtube.openDownloads().catch(console.error)};return e.jsxs("div",{className:"p-8 space-y-8 animate-in fade-in duration-500",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-red-500/10 rounded-xl",children:e.jsx(s.Youtube,{className:"w-8 h-8 text-red-500"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"YouTube Downloader"}),e.jsx("p",{className:"text-gray-400",children:"MP3, MP4 et Playlists"}),p&&e.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-yellow-500 animate-pulse",children:[e.jsx(s.Loader2,{className:"w-4 h-4 animate-spin"}),p]})]})]}),e.jsxs("button",{onClick:L,className:"p-3 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors flex items-center gap-2 border border-gray-700",title:"Ouvrir le dossier de téléchargement",children:[e.jsx(s.FolderOpen,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:"Ouvrir dossier"})]})]}),e.jsx("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-800 shadow-xl backdrop-blur-sm",children:e.jsxs("form",{onSubmit:V,className:"relative flex gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(s.Search,{className:"h-5 w-5 text-gray-500"})}),e.jsx("input",{type:"text",value:a,onChange:g=>u(g.target.value),className:"block w-full pl-11 pr-4 py-4 bg-gray-950 border border-gray-800 rounded-xl text-gray-100 placeholder-gray-500 focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50 focus:outline-none transition-all",placeholder:"Collez un lien YouTube (Vidéo ou Playlist)..."})]}),e.jsx("button",{type:"submit",disabled:c||!a||!!p,className:"px-8 py-4 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-xl transition-colors flex items-center gap-2 min-w-[140px] justify-center shadow-lg shadow-red-900/20",children:c?e.jsx(s.Loader2,{className:"w-5 h-5 animate-spin"}):"Rechercher"})]})}),o&&e.jsx("div",{className:"bg-gray-800/40 rounded-2xl border border-gray-700/50 overflow-hidden animate-in slide-in-from-bottom-4 duration-500",children:e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsxs("div",{className:"md:w-80 h-56 relative group bg-black/50 flex-shrink-0",children:[o.thumbnail?e.jsx("img",{src:o.thumbnail,alt:o.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:e.jsx(s.Music,{className:"w-16 h-16"})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4",children:e.jsx("span",{className:"text-white text-sm font-medium bg-red-600 px-2 py-1 rounded",children:o.duration})}),o.isPlaylist&&e.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs font-medium flex items-center gap-2 border border-white/10",children:[e.jsx(s.ListVideo,{className:"w-3 h-3"}),"Playlist (",o.playlistCount,")"]})]}),e.jsxs("div",{className:"p-6 flex flex-col justify-between flex-1 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white line-clamp-2 mb-2 leading-tight",children:o.title}),e.jsxs("p",{className:"text-gray-400 font-medium flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs",children:o.author.substring(0,2).toUpperCase()}),o.author]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider flex items-center gap-1",children:[e.jsx(s.Settings2,{className:"w-3 h-3"})," Format"]}),e.jsxs("div",{className:"flex bg-gray-900/50 p-1 rounded-lg border border-gray-700/50",children:[e.jsxs("button",{onClick:()=>x("mp3"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-all ${l==="mp3"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(s.Music,{className:"w-4 h-4"})," MP3"]}),e.jsxs("button",{onClick:()=>x("mp4"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-all ${l==="mp4"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[e.jsx(s.Video,{className:"w-4 h-4"})," MP4"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider flex items-center gap-1",children:"Qualité"}),e.jsxs("select",{value:I,onChange:g=>Y(g.target.value),className:"w-full bg-gray-900/50 border border-gray-700/50 text-gray-200 text-sm rounded-lg focus:ring-red-500 focus:border-red-500 block p-2.5 outline-none",children:[e.jsx("option",{value:"best",children:"Meilleure (320k / HD)"}),e.jsx("option",{value:"high",children:"Haute (192k / 720p)"}),e.jsx("option",{value:"medium",children:"Moyenne (128k / 480p)"}),e.jsx("option",{value:"low",children:"Basse (64k / 360p)"})]})]})]}),e.jsx("div",{className:"space-y-4",children:i?e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700/50 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-end text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-white font-medium",children:[e.jsx(s.Loader2,{className:"w-4 h-4 animate-spin text-red-500"}),e.jsx("span",{children:t.total&&t.total>1?"Téléchargement de la playlist...":"Téléchargement en cours..."})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-red-400 font-bold",children:[Math.round(t.total&&t.total>1?((t.current||1)-1)/t.total*100+t.percent/t.total:t.percent),"%"]}),e.jsx("button",{onClick:n,className:"p-1 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",title:"Annuler le téléchargement",children:e.jsx(s.X,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"h-2.5 w-full bg-gray-700 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-red-500 transition-all duration-300 ease-out",style:{width:`${t.total&&t.total>1?((t.current||1)-1)/t.total*100+t.percent/t.total:t.percent}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[e.jsx("span",{children:t.total&&t.total>1?`Vidéo ${t.current} sur ${t.total}`:"Traitement en cours..."}),t.eta&&e.jsxs("span",{children:["Temps restant : ",e.jsx("span",{className:"text-gray-300",children:t.eta})]})]}),t.total&&t.total>1&&e.jsxs("div",{className:"space-y-1 mt-2 pt-2 border-t border-gray-700/30",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 uppercase tracking-wider",children:[e.jsx("span",{children:"Fichier actuel"}),e.jsxs("span",{children:[Math.round(t.percent),"%"]})]}),e.jsx("div",{className:"h-1 w-full bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gray-400 transition-all duration-300 ease-out",style:{width:`${t.percent}%`}})})]})]}):e.jsxs("button",{onClick:q,className:"w-full py-4 bg-white hover:bg-gray-50 text-gray-900 font-bold rounded-xl transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl hover:shadow-2xl active:scale-[0.99]",children:[e.jsx(s.Download,{className:"w-5 h-5"}),e.jsxs("span",{children:["Télécharger ",o.isPlaylist?"la playlist":"maintenant"]})]})})]})]})]})}),!o&&!c&&e.jsxs("div",{className:"grid md:grid-cols-3 gap-6 pt-8",children:[e.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:e.jsx(s.Music,{className:"w-6 h-6 text-red-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Haute Qualité Audio"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Conversion en MP3 jusqu'à 320kbps pour une expérience d'écoute optimale."})]}),e.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:e.jsx(s.ListVideo,{className:"w-6 h-6 text-red-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Support Playlists"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Téléchargez des playlists entières en un seul clic."})]}),e.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:e.jsx(s.Video,{className:"w-6 h-6 text-red-500"})}),e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"MP3 & MP4"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Choisissez entre format audio ou vidéo selon vos besoins."})]})]})]})}function A(){return e.jsx(D,{children:e.jsx(E,{})})}return{manifest:{id:"youtubetomp3",name:"Youtube To MP3",version:"1.0.0",description:"Téléchargement de vidéos et playlists YouTube en MP3/MP4",author:"MoowGlax",main:"index.tsx",icon:"Youtube",permissions:["youtube"]},routes:[{path:"/youtube",element:e.jsx(A,{})}],sidebarItems:[{id:"youtube",label:"YouTube",icon:s.Youtube,path:"/youtube",order:4}]}}));
