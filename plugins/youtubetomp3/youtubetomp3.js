(function(a,o){typeof exports=="object"&&typeof module<"u"?module.exports=o(require("react"),require("lucide-react"),require("sonner")):typeof define=="function"&&define.amd?define(["react","lucide-react","sonner"],o):(a=typeof globalThis<"u"?globalThis:a||self,a.youtubetomp3=o(a.React,a.LucideReact,a.Sonner))})(this,(function(a,o,P){"use strict";var A={exports:{}},k={};var B;function ee(){if(B)return k;B=1;var m=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function x(y,c,d){var b=null;if(d!==void 0&&(b=""+d),c.key!==void 0&&(b=""+c.key),"key"in c){d={};for(var h in c)h!=="key"&&(d[h]=c[h])}else d=c;return c=d.ref,{$$typeof:m,type:y,key:b,ref:c!==void 0?c:null,props:d}}return k.Fragment=s,k.jsx=x,k.jsxs=x,k}var S={};var J;function te(){return J||(J=1,process.env.NODE_ENV!=="production"&&(function(){function m(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===ie?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case R:return"Fragment";case I:return"Profiler";case f:return"StrictMode";case v:return"Suspense";case Y:return"SuspenseList";case le:return"Activity"}if(typeof e=="object")switch(typeof e.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),e.$$typeof){case O:return"Portal";case M:return e.displayName||"Context";case D:return(e._context.displayName||"Context")+".Consumer";case j:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case L:return r=e.displayName||null,r!==null?r:m(e.type)||"Memo";case F:r=e._payload,e=e._init;try{return m(e(r))}catch{}}return null}function s(e){return""+e}function x(e){try{s(e);var r=!1}catch{r=!0}if(r){r=console;var n=r.error,l=typeof Symbol=="function"&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object";return n.call(r,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",l),s(e)}}function y(e){if(e===R)return"<>";if(typeof e=="object"&&e!==null&&e.$$typeof===F)return"<...>";try{var r=m(e);return r?"<"+r+">":"<...>"}catch{return"<...>"}}function c(){var e=V.A;return e===null?null:e.getOwner()}function d(){return Error("react-stack-top-frame")}function b(e){if(H.call(e,"key")){var r=Object.getOwnPropertyDescriptor(e,"key").get;if(r&&r.isReactWarning)return!1}return e.key!==void 0}function h(e,r){function n(){Q||(Q=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",r))}n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}function T(){var e=m(this.type);return Z[e]||(Z[e]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),e=this.props.ref,e!==void 0?e:null}function N(e,r,n,l,C,W){var i=n.ref;return e={$$typeof:p,type:e,key:r,props:n,_owner:l},(i!==void 0?i:null)!==null?Object.defineProperty(e,"ref",{enumerable:!1,get:T}):Object.defineProperty(e,"ref",{enumerable:!1,value:null}),e._store={},Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(e,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(e,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:C}),Object.defineProperty(e,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:W}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e}function E(e,r,n,l,C,W){var i=r.children;if(i!==void 0)if(l)if(ce(i)){for(l=0;l<i.length;l++)w(i[l]);Object.freeze&&Object.freeze(i)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else w(i);if(H.call(r,"key")){i=m(e);var _=Object.keys(r).filter(function(de){return de!=="key"});l=0<_.length?"{key: someKey, "+_.join(": ..., ")+": ...}":"{key: someKey}",$[i+l]||(_=0<_.length?"{"+_.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,l,i,_,i),$[i+l]=!0)}if(i=null,n!==void 0&&(x(n),i=""+n),b(r)&&(x(r.key),i=""+r.key),"key"in r){n={};for(var z in r)z!=="key"&&(n[z]=r[z])}else n=r;return i&&h(n,typeof e=="function"?e.displayName||e.name||"Unknown":e),N(e,i,n,c(),C,W)}function w(e){g(e)?e._store&&(e._store.validated=1):typeof e=="object"&&e!==null&&e.$$typeof===F&&(e._payload.status==="fulfilled"?g(e._payload.value)&&e._payload.value._store&&(e._payload.value._store.validated=1):e._store&&(e._store.validated=1))}function g(e){return typeof e=="object"&&e!==null&&e.$$typeof===p}var u=a,p=Symbol.for("react.transitional.element"),O=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),I=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),M=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),le=Symbol.for("react.activity"),ie=Symbol.for("react.client.reference"),V=u.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H=Object.prototype.hasOwnProperty,ce=Array.isArray,U=console.createTask?console.createTask:function(){return null};u={react_stack_bottom_frame:function(e){return e()}};var Q,Z={},q=u.react_stack_bottom_frame.bind(u,d)(),K=U(y(d)),$={};S.Fragment=R,S.jsx=function(e,r,n){var l=1e4>V.recentlyCreatedOwnerStacks++;return E(e,r,n,!1,l?Error("react-stack-top-frame"):q,l?U(y(e)):K)},S.jsxs=function(e,r,n){var l=1e4>V.recentlyCreatedOwnerStacks++;return E(e,r,n,!0,l?Error("react-stack-top-frame"):q,l?U(y(e)):K)}})()),S}var G;function re(){return G||(G=1,process.env.NODE_ENV==="production"?A.exports=ee():A.exports=te()),A.exports}var t=re();const X=a.createContext(void 0);function se({children:m}){const[s,x]=a.useState(!1),[y,c]=a.useState({percent:0}),[d,b]=a.useState(null),h=a.useCallback(async(N,E,w)=>{x(!0),b(w),c({percent:0});let g;try{g=window.electronAPI.youtube.onDownloadProgress(p=>{c(p)});const u=await window.electronAPI.youtube.download(N,E);if(u&&!u.success)throw new Error(u.error||"Download failed");P.toast.success("Téléchargement terminé !");try{await window.electronAPI.notify("Téléchargement terminé",`${w.title} a été téléchargé avec succès.`)}catch(p){console.error("Erreur notification",p)}c({percent:100}),setTimeout(()=>{x(!1),c({percent:0}),b(null)},3e3)}catch(u){if(console.error(u),u.message&&u.message.includes("annulé"))P.toast.info("Téléchargement annulé");else{P.toast.error("Erreur lors du téléchargement : "+u.message);try{await window.electronAPI.notify("Erreur de téléchargement",u.message||"Une erreur est survenue")}catch(p){console.error(p)}}x(!1)}finally{g&&g()}},[]),T=a.useCallback(async()=>{console.log("Cancelling download...");try{await window.electronAPI.youtube.cancel(),console.log("Cancellation request sent")}catch(N){console.error("Erreur lors de l'annulation",N)}},[]);return t.jsx(X.Provider,{value:{isDownloading:s,progress:y,videoInfo:d,startDownload:h,cancelDownload:T},children:m})}function ae(){const m=a.useContext(X);if(m===void 0)throw new Error("useDownload must be used within a DownloadProvider");return m}function ne(){const{isDownloading:m,progress:s,videoInfo:x,startDownload:y,cancelDownload:c}=ae(),[d,b]=a.useState(""),[h,T]=a.useState(!1),[N,E]=a.useState(null),[w,g]=a.useState("Vérification des composants..."),[u,p]=a.useState("mp3"),[O,R]=a.useState("best"),f=m&&x?x:N;a.useEffect(()=>{(async()=>{try{const v=window.electronAPI.youtube.onBinaryProgress(L=>{g(L)});await window.electronAPI.youtube.checkBinaries();const Y=await window.electronAPI.youtube.getBinariesPath();console.log("Binaries path:",Y),g(null),v()}catch(v){console.error(v),g("Erreur lors du chargement des composants."),P.toast.error("Impossible de charger les composants nécessaires.")}})()},[]);const I=async j=>{if(j.preventDefault(),!!d.trim()){T(!0),E(null);try{const v=await window.electronAPI.youtube.getInfo(d);E(v)}catch(v){console.error(v),P.toast.error("Impossible de récupérer les infos de la vidéo.")}finally{T(!1)}}},D=async()=>{f&&(m||await y(d,{format:u,quality:O},f))},M=()=>{window.electronAPI.youtube.openDownloads().catch(console.error)};return t.jsxs("div",{className:"p-8 max-w-5xl mx-auto space-y-8 animate-in fade-in duration-500",children:[t.jsxs("div",{className:"flex items-center justify-between mb-8",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-3 bg-red-500/10 rounded-xl",children:t.jsx(o.Youtube,{className:"w-8 h-8 text-red-500"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-white",children:"YouTube Downloader"}),t.jsx("p",{className:"text-gray-400",children:"MP3, MP4 et Playlists"}),w&&t.jsxs("div",{className:"flex items-center gap-2 mt-2 text-sm text-yellow-500 animate-pulse",children:[t.jsx(o.Loader2,{className:"w-4 h-4 animate-spin"}),w]})]})]}),t.jsxs("button",{onClick:M,className:"p-3 bg-gray-800 hover:bg-gray-700 text-gray-300 rounded-xl transition-colors flex items-center gap-2 border border-gray-700",title:"Ouvrir le dossier de téléchargement",children:[t.jsx(o.FolderOpen,{className:"w-5 h-5"}),t.jsx("span",{className:"hidden sm:inline",children:"Ouvrir dossier"})]})]}),t.jsx("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-800 shadow-xl backdrop-blur-sm",children:t.jsxs("form",{onSubmit:I,className:"relative flex gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:t.jsx(o.Search,{className:"h-5 w-5 text-gray-500"})}),t.jsx("input",{type:"text",value:d,onChange:j=>b(j.target.value),className:"block w-full pl-11 pr-4 py-4 bg-gray-950 border border-gray-800 rounded-xl text-gray-100 placeholder-gray-500 focus:border-red-500/50 focus:ring-1 focus:ring-red-500/50 focus:outline-none transition-all",placeholder:"Collez un lien YouTube (Vidéo ou Playlist)..."})]}),t.jsx("button",{type:"submit",disabled:h||!d||!!w,className:"px-8 py-4 bg-red-600 hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-medium rounded-xl transition-colors flex items-center gap-2 min-w-[140px] justify-center shadow-lg shadow-red-900/20",children:h?t.jsx(o.Loader2,{className:"w-5 h-5 animate-spin"}):"Rechercher"})]})}),f&&t.jsx("div",{className:"bg-gray-800/40 rounded-2xl border border-gray-700/50 overflow-hidden animate-in slide-in-from-bottom-4 duration-500",children:t.jsxs("div",{className:"flex flex-col md:flex-row",children:[t.jsxs("div",{className:"md:w-80 h-56 relative group bg-black/50 flex-shrink-0",children:[f.thumbnail?t.jsx("img",{src:f.thumbnail,alt:f.title,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}):t.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-600",children:t.jsx(o.Music,{className:"w-16 h-16"})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end p-4",children:t.jsx("span",{className:"text-white text-sm font-medium bg-red-600 px-2 py-1 rounded",children:f.duration})}),f.isPlaylist&&t.jsxs("div",{className:"absolute top-2 right-2 bg-black/70 backdrop-blur-sm text-white px-3 py-1 rounded-full text-xs font-medium flex items-center gap-2 border border-white/10",children:[t.jsx(o.ListVideo,{className:"w-3 h-3"}),"Playlist (",f.playlistCount,")"]})]}),t.jsxs("div",{className:"p-6 flex flex-col justify-between flex-1 gap-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white line-clamp-2 mb-2 leading-tight",children:f.title}),t.jsxs("p",{className:"text-gray-400 font-medium flex items-center gap-2",children:[t.jsx("span",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center text-xs",children:f.author.substring(0,2).toUpperCase()}),f.author]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("label",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider flex items-center gap-1",children:[t.jsx(o.Settings2,{className:"w-3 h-3"})," Format"]}),t.jsxs("div",{className:"flex bg-gray-900/50 p-1 rounded-lg border border-gray-700/50",children:[t.jsxs("button",{onClick:()=>p("mp3"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-all ${u==="mp3"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[t.jsx(o.Music,{className:"w-4 h-4"})," MP3"]}),t.jsxs("button",{onClick:()=>p("mp4"),className:`flex-1 flex items-center justify-center gap-2 py-2 rounded-md text-sm font-medium transition-all ${u==="mp4"?"bg-red-600 text-white shadow-lg":"text-gray-400 hover:text-white"}`,children:[t.jsx(o.Video,{className:"w-4 h-4"})," MP4"]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"text-xs text-gray-500 font-medium uppercase tracking-wider flex items-center gap-1",children:"Qualité"}),t.jsxs("select",{value:O,onChange:j=>R(j.target.value),className:"w-full bg-gray-900/50 border border-gray-700/50 text-gray-200 text-sm rounded-lg focus:ring-red-500 focus:border-red-500 block p-2.5 outline-none",children:[t.jsx("option",{value:"best",children:"Meilleure (320k / HD)"}),t.jsx("option",{value:"high",children:"Haute (192k / 720p)"}),t.jsx("option",{value:"medium",children:"Moyenne (128k / 480p)"}),t.jsx("option",{value:"low",children:"Basse (64k / 360p)"})]})]})]}),t.jsx("div",{className:"space-y-4",children:m?t.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700/50 space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-end text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2 text-white font-medium",children:[t.jsx(o.Loader2,{className:"w-4 h-4 animate-spin text-red-500"}),t.jsx("span",{children:s.total&&s.total>1?"Téléchargement de la playlist...":"Téléchargement en cours..."})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("span",{className:"text-red-400 font-bold",children:[Math.round(s.total&&s.total>1?((s.current||1)-1)/s.total*100+s.percent/s.total:s.percent),"%"]}),t.jsx("button",{onClick:c,className:"p-1 hover:bg-white/10 rounded-full transition-colors text-gray-400 hover:text-white",title:"Annuler le téléchargement",children:t.jsx(o.X,{className:"w-4 h-4"})})]})]}),t.jsx("div",{className:"h-2.5 w-full bg-gray-700 rounded-full overflow-hidden shadow-inner",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-red-600 to-red-500 transition-all duration-300 ease-out",style:{width:`${s.total&&s.total>1?((s.current||1)-1)/s.total*100+s.percent/s.total:s.percent}%`}})}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-400 font-medium",children:[t.jsx("span",{children:s.total&&s.total>1?`Vidéo ${s.current} sur ${s.total}`:"Traitement en cours..."}),s.eta&&t.jsxs("span",{children:["Temps restant : ",t.jsx("span",{className:"text-gray-300",children:s.eta})]})]}),s.total&&s.total>1&&t.jsxs("div",{className:"space-y-1 mt-2 pt-2 border-t border-gray-700/30",children:[t.jsxs("div",{className:"flex justify-between text-[10px] text-gray-500 uppercase tracking-wider",children:[t.jsx("span",{children:"Fichier actuel"}),t.jsxs("span",{children:[Math.round(s.percent),"%"]})]}),t.jsx("div",{className:"h-1 w-full bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gray-400 transition-all duration-300 ease-out",style:{width:`${s.percent}%`}})})]})]}):t.jsxs("button",{onClick:D,className:"w-full py-4 bg-white hover:bg-gray-50 text-gray-900 font-bold rounded-xl transition-all flex items-center justify-center gap-3 disabled:opacity-50 disabled:cursor-not-allowed shadow-xl hover:shadow-2xl active:scale-[0.99]",children:[t.jsx(o.Download,{className:"w-5 h-5"}),t.jsxs("span",{children:["Télécharger ",f.isPlaylist?"la playlist":"maintenant"]})]})})]})]})]})}),!f&&!h&&t.jsxs("div",{className:"grid md:grid-cols-3 gap-6 pt-8",children:[t.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[t.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:t.jsx(o.Music,{className:"w-6 h-6 text-red-500"})}),t.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Haute Qualité Audio"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Conversion en MP3 jusqu'à 320kbps pour une expérience d'écoute optimale."})]}),t.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[t.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:t.jsx(o.ListVideo,{className:"w-6 h-6 text-red-500"})}),t.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Support Playlists"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Téléchargez des playlists entières en un seul clic."})]}),t.jsxs("div",{className:"bg-gray-800/30 p-6 rounded-2xl border border-gray-800 hover:border-red-500/30 transition-colors",children:[t.jsx("div",{className:"w-12 h-12 bg-red-500/10 rounded-xl flex items-center justify-center mb-4",children:t.jsx(o.Video,{className:"w-6 h-6 text-red-500"})}),t.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"MP3 & MP4"}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Choisissez entre format audio ou vidéo selon vos besoins."})]})]})]})}function oe(){return t.jsx(se,{children:t.jsx(ne,{})})}return{manifest:{id:"youtubetomp3",name:"Youtube To MP3",version:"1.0.0",description:"Téléchargement de vidéos et playlists YouTube en MP3/MP4",author:"MoowGlax",main:"index.tsx",icon:"Youtube",permissions:["youtube"]},routes:[{path:"/youtube",element:t.jsx(oe,{})}],sidebarItems:[{id:"youtube",label:"YouTube",icon:o.Youtube,path:"/youtube",order:4}]}}));
