(function(A,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("react"),require("lucide-react"),require("react-router-dom"),require("sonner")):typeof define=="function"&&define.amd?define(["exports","react","lucide-react","react-router-dom","sonner"],c):(A=typeof globalThis<"u"?globalThis:A||self,c(A.prowlarr={},A.React,A.LucideReact,A.ReactRouterDOM,A.Sonner))})(this,(function(A,c,d,oe,P){"use strict";var J={exports:{}},W={};var le;function he(){if(le)return W;le=1;var n=Symbol.for("react.transitional.element"),o=Symbol.for("react.fragment");function x(u,l,m){var w=null;if(m!==void 0&&(w=""+m),l.key!==void 0&&(w=""+l.key),"key"in l){m={};for(var j in l)j!=="key"&&(m[j]=l[j])}else m=l;return l=m.ref,{$$typeof:n,type:u,key:w,ref:l!==void 0?l:null,props:m}}return W.Fragment=o,W.jsx=x,W.jsxs=x,W}var z={};var ce;function pe(){return ce||(ce=1,process.env.NODE_ENV!=="production"&&(function(){function n(t){if(t==null)return null;if(typeof t=="function")return t.$$typeof===ae?null:t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case I:return"Fragment";case O:return"Profiler";case B:return"StrictMode";case se:return"Suspense";case D:return"SuspenseList";case q:return"Activity"}if(typeof t=="object")switch(typeof t.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),t.$$typeof){case T:return"Portal";case F:return t.displayName||"Context";case H:return(t._context.displayName||"Context")+".Consumer";case Q:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Z:return s=t.displayName||null,s!==null?s:n(t.type)||"Memo";case V:s=t._payload,t=t._init;try{return n(t(s))}catch{}}return null}function o(t){return""+t}function x(t){try{o(t);var s=!1}catch{s=!0}if(s){s=console;var f=s.error,p=typeof Symbol=="function"&&Symbol.toStringTag&&t[Symbol.toStringTag]||t.constructor.name||"Object";return f.call(s,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",p),o(t)}}function u(t){if(t===I)return"<>";if(typeof t=="object"&&t!==null&&t.$$typeof===V)return"<...>";try{var s=n(t);return s?"<"+s+">":"<...>"}catch{return"<...>"}}function l(){var t=U.A;return t===null?null:t.getOwner()}function m(){return Error("react-stack-top-frame")}function w(t){if($.call(t,"key")){var s=Object.getOwnPropertyDescriptor(t,"key").get;if(s&&s.isReactWarning)return!1}return t.key!==void 0}function j(t,s){function f(){K||(K=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",s))}f.isReactWarning=!0,Object.defineProperty(t,"key",{get:f,configurable:!0})}function v(){var t=n(this.type);return M[t]||(M[t]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),t=this.props.ref,t!==void 0?t:null}function N(t,s,f,p,Y,r){var a=f.ref;return t={$$typeof:k,type:t,key:s,props:f,_owner:p},(a!==void 0?a:null)!==null?Object.defineProperty(t,"ref",{enumerable:!1,get:v}):Object.defineProperty(t,"ref",{enumerable:!1,value:null}),t._store={},Object.defineProperty(t._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(t,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(t,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Y}),Object.defineProperty(t,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:r}),Object.freeze&&(Object.freeze(t.props),Object.freeze(t)),t}function h(t,s,f,p,Y,r){var a=s.children;if(a!==void 0)if(p)if(ee(a)){for(p=0;p<a.length;p++)y(a[p]);Object.freeze&&Object.freeze(a)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else y(a);if($.call(s,"key")){a=n(t);var i=Object.keys(s).filter(function(C){return C!=="key"});p=0<i.length?"{key: someKey, "+i.join(": ..., ")+": ...}":"{key: someKey}",te[a+p]||(i=0<i.length?"{"+i.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,p,a,i,a),te[a+p]=!0)}if(a=null,f!==void 0&&(x(f),a=""+f),w(s)&&(x(s.key),a=""+s.key),"key"in s){f={};for(var g in s)g!=="key"&&(f[g]=s[g])}else f=s;return a&&j(f,typeof t=="function"?t.displayName||t.name||"Unknown":t),N(t,a,f,l(),Y,r)}function y(t){R(t)?t._store&&(t._store.validated=1):typeof t=="object"&&t!==null&&t.$$typeof===V&&(t._payload.status==="fulfilled"?R(t._payload.value)&&t._payload.value._store&&(t._payload.value._store.validated=1):t._store&&(t._store.validated=1))}function R(t){return typeof t=="object"&&t!==null&&t.$$typeof===k}var b=c,k=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),B=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),F=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),se=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),Z=Symbol.for("react.memo"),V=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),ae=Symbol.for("react.client.reference"),U=b.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=Object.prototype.hasOwnProperty,ee=Array.isArray,G=console.createTask?console.createTask:function(){return null};b={react_stack_bottom_frame:function(t){return t()}};var K,M={},L=b.react_stack_bottom_frame.bind(b,m)(),X=G(u(m)),te={};z.Fragment=I,z.jsx=function(t,s,f){var p=1e4>U.recentlyCreatedOwnerStacks++;return h(t,s,f,!1,p?Error("react-stack-top-frame"):L,p?G(u(t)):X)},z.jsxs=function(t,s,f){var p=1e4>U.recentlyCreatedOwnerStacks++;return h(t,s,f,!0,p?Error("react-stack-top-frame"):L,p?G(u(t)):X)}})()),z}var ie;function ge(){return ie||(ie=1,process.env.NODE_ENV==="production"?J.exports=he():J.exports=pe()),J.exports}var e=ge();let E="",_="";const de=3600*1e3,re=new Map,ue=n=>{const o=re.get(n);return o&&Date.now()-o.timestamp<de?o.data:null},xe=(n,o)=>{re.set(n,{data:o,timestamp:Date.now()})},S={init:async()=>{const n=await window.electronAPI.getCredentials("prowlarr_url"),o=await window.electronAPI.getCredentials("prowlarr_apikey");E=n||"",_=o||""},testConnection:async(n,o)=>{try{return(await window.electronAPI.proxyRequest(`${n}/api/v1/health`,{headers:{"X-Api-Key":o}})).ok}catch(x){return console.error("Prowlarr connection test failed",x),!1}},getNextUpdate:()=>{let n=0;for(const o of re.values())o.timestamp>n&&(n=o.timestamp);return n>0?n+de:null},checkHealth:async()=>{try{if(await S.init(),!E||!_)return!1;const n=E.replace(/\/$/,"");return(await window.electronAPI.proxyRequest(`${n}/api/v1/health`,{headers:{"X-Api-Key":_}})).ok}catch{return!1}},getStats:async(n=!1)=>{if(await S.init(),!E||!_)return{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0};const o=E.replace(/\/$/,""),x=`stats-${o}`;if(!n){const u=ue(x);if(u)return u}try{const u=await window.electronAPI.proxyRequest(`${o}/api/v1/indexer`,{headers:{"X-Api-Key":_,Accept:"application/json"}});if(u.ok&&Array.isArray(u.data)){const l=u.data,m={indexerCount:l.length,enabledIndexerCount:l.filter(w=>w.enable).length,latestReleaseCount:0};return xe(x,m),m}return{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0}}catch(u){return console.error("Failed to get Prowlarr stats",u),{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0}}},search:async(n="",o=!1)=>{if(await S.init(),!E||!_)return console.warn("Prowlarr credentials missing",{currentUrl:E,hasKey:!!_}),[];const x=E.replace(/\/$/,""),u=`search-${n}-${x}`;if(!o){const l=ue(u);if(l)return l}try{const l=encodeURIComponent(n),m=`${x}/api/v1/search?query=${l}&type=search&limit=100&offset=0&apikey=${_}`;console.log("Fetching Prowlarr (Direct URL):",m);const w=await window.electronAPI.proxyRequest(m,{method:"GET",headers:{"X-Api-Key":_,Accept:"application/json"},timeout:6e4});if(console.log("Prowlarr Raw Response:",w),!w||!w.ok)return console.error("Prowlarr API Error - Not OK:",w),[];let j=[];const v=w.data;if(Array.isArray(v))j=v;else if(v&&typeof v=="object")if("records"in v&&Array.isArray(v.records))j=v.records;else{const h=Object.values(v).find(y=>Array.isArray(y));h?j=h:j=Object.values(v).filter(y=>y&&y.guid)}console.log(`Parsed ${j.length} results`);const N=j.map(h=>({guid:h.guid,indexerId:h.indexerId,indexer:h.indexer,title:h.title,publishDate:h.publishDate||h.added||new Date().toISOString(),size:h.size,downloadUrl:h.downloadUrl,magnetUrl:h.magnetUrl,protocol:h.protocol,seeders:h.seeders,leechers:h.leechers}));return xe(u,N),N}catch(l){return console.error("Prowlarr search failed",l),[]}},getPublicUrl:async()=>(E||await S.init(),E)};function me(n,o=2){if(!+n)return"0 Bytes";const x=1024,u=o<0?0:o,l=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],m=Math.floor(Math.log(n)/Math.log(x));return`${parseFloat((n/Math.pow(x,m)).toFixed(u))} ${l[m]}`}function fe(n){const o=new Date(n);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(o)}const we=n=>{const o=n.toUpperCase();return/\b(FRENCH|TRUEFRENCH|VFF|VF|VOSTFR|MULTI)\b/.test(o)};function je(){const n=oe.useNavigate(),o=oe.useLocation(),[x,u]=c.useState(null),[l,m]=c.useState([]),[w,j]=c.useState(null),[v,N]=c.useState(!1),[h,y]=c.useState(""),[R,b]=c.useState(null),[k,T]=c.useState(""),[I,B]=c.useState(!1),[O,H]=c.useState(""),[F,Q]=c.useState([]),[se,D]=c.useState(!1);c.useEffect(()=>{(async()=>{const a=o.state;if(a?.search){const i=a.search;H(i),B(!0),D(!0);try{const g=await S.search(i,!0);Q(g)}catch(g){console.error("Auto search failed",g)}finally{D(!1)}}})()},[]);const[Z,V]=c.useState("all"),[q,ae]=c.useState(!1),[U,$]=c.useState("all"),[ee,G]=c.useState(!1),K=(r,a,i)=>r.filter(g=>!(a!=="all"&&g.indexer!==a||i&&!we(g.title))),M=K(l,Z,q),L=K(F,U,ee),X=r=>Array.from(new Set(r.map(a=>a.indexer))).sort(),te=X(l),t=X(F);c.useEffect(()=>{const r=setInterval(()=>{if(!R){T("");return}const a=Date.now(),i=R-a;if(i<=0){T("Mise √† jour..."),s(!0,!0);return}if(i>36e5){const g=Math.floor(i/36e5),C=Math.floor(i%36e5/6e4);T(`${g}h ${C}m`)}else{const g=Math.floor(i/6e4),C=Math.floor(i%6e4/1e3);T(`${g}m ${C}s`)}},1e3);return()=>clearInterval(r)},[R]),c.useEffect(()=>{(async()=>{const a=await window.electronAPI.getCredentials("prowlarr_configured"),i=await window.electronAPI.getCredentials("prowlarr_url");i&&y(i),a?(j(!0),s()):(j(!1),setTimeout(()=>{n("/settings",{state:{section:"prowlarr"}})},2e3))})()},[n]);const s=async(r=!1,a=!1)=>{N(!0);try{const i=await S.getStats(r);u(i);const g=await S.search("",r);m(g);const C=S.getNextUpdate();b(C),a&&r&&P.toast.success("Prowlarr: Actualisation termin√©e")}catch(i){console.error("Failed to load Prowlarr data",i)}finally{N(!1)}},f=async r=>{if(r&&(r.preventDefault(),r.stopPropagation()),!!O.trim()){D(!0);try{const a=await S.search(O,!0);Q(a)}catch(a){console.error("Search failed",a)}finally{D(!1)}}},p=async r=>{const a=r.magnetUrl||r.downloadUrl;if(!a){P.toast.error("Lien de t√©l√©chargement introuvable");return}const i=window.PluginManager?.getService("download");if(!i){P.toast.error("Aucun client de t√©l√©chargement configur√©");return}const g=P.toast.loading(`Ajout de "${r.title}"...`);if(a.startsWith("magnet:"))await i.addTorrentMagnet(a)?P.toast.success(`"${r.title}" ajout√© avec succ√®s`,{id:g}):P.toast.error("√âchec de l'ajout au client de t√©l√©chargement",{id:g});else try{const ye=await(await fetch(a)).blob(),ne=new FileReader;ne.onload=async()=>{const Ne=ne.result.split(",")[1];await i.addTorrentFile(`${r.title}.torrent`,Ne)?P.toast.success(`"${r.title}" ajout√© avec succ√®s`,{id:g}):P.toast.error("√âchec de l'ajout au client de t√©l√©chargement",{id:g})},ne.readAsDataURL(ye)}catch(C){console.error(C),P.toast.error("Impossible de t√©l√©charger le fichier torrent",{id:g,description:"Le lien Magnet n'est pas disponible."})}},Y=()=>{h&&window.open(h,"_blank")};return w===!1?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(d.AlertCircle,{className:"mx-auto h-12 w-12 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Module non configur√©"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirection vers les param√®tres..."})]})]})}):w===null?e.jsx("div",{children:"Chargement..."}):e.jsxs("div",{className:"space-y-6 h-full flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(d.Database,{className:"h-6 w-6"}),"Prowlarr"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>B(!0),className:"flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90",children:[e.jsx(d.Search,{className:"h-4 w-4"})," Rechercher"]}),e.jsxs("button",{onClick:Y,className:"flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-muted",children:[e.jsx(d.ExternalLink,{className:"h-4 w-4"})," Interface Web"]})]})]}),x&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(d.Globe,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Indexeurs Totaux"}),e.jsx("div",{className:"text-2xl font-bold",children:x.indexerCount})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-full",children:e.jsx(d.Wifi,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Actifs"}),e.jsx("div",{className:"text-2xl font-bold",children:x.enabledIndexerCount})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-full",children:e.jsx(d.Calendar,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Derni√®res Sorties"}),e.jsx("div",{className:"text-2xl font-bold",children:l.length})]})]})]}),e.jsxs("div",{className:"flex-1 rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b bg-muted/30 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[e.jsx(d.Calendar,{className:"h-5 w-5 text-muted-foreground"}),"Derni√®res sorties"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[k&&e.jsxs("span",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded",children:["Prochaine maj: ",k]}),e.jsx("button",{onClick:()=>s(!0),disabled:v,className:"p-1 hover:bg-muted rounded-full transition-colors",title:"Actualiser",children:e.jsx(d.RefreshCw,{className:`h-4 w-4 ${v?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d.Filter,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Filtres:"})]}),e.jsxs("select",{value:Z,onChange:r=>V(r.target.value),className:"bg-background border rounded px-2 py-1 outline-none focus:ring-1 focus:ring-primary max-w-[200px]",children:[e.jsx("option",{value:"all",children:"Tous les indexeurs"}),te.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none bg-muted/50 px-2 py-1 rounded hover:bg-muted transition-colors",children:[e.jsx("input",{type:"checkbox",checked:q,onChange:r=>ae(r.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{children:"üá´üá∑ FR / Multi"})]}),e.jsxs("div",{className:"flex-1 text-right text-muted-foreground text-xs",children:[M.length," / ",l.length," r√©sultat(s)"]})]})]}),e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-xs uppercase font-medium text-muted-foreground sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Titre"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Indexeur"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Taille"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y",children:[M.map(r=>e.jsxs("tr",{className:"hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:e.jsx("div",{className:"truncate max-w-[300px]",title:r.title,children:r.title})}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:r.indexer}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:me(r.size)}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:fe(r.publishDate)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>p(r),className:"inline-flex items-center gap-1 rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary hover:bg-primary/20 transition-colors",title:"T√©l√©charger",children:[e.jsx(d.Download,{className:"h-3 w-3"}),"DL"]})})]},r.guid)),M.length===0&&!v&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-muted-foreground",children:l.length===0?"Aucune sortie r√©cente trouv√©e. V√©rifiez vos indexeurs.":"Aucun r√©sultat pour ces filtres."})}),v&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-muted-foreground",children:"Chargement..."})})]})]})})]}),I&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border shadow-lg rounded-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center gap-4",children:[e.jsx(d.Search,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("form",{onSubmit:f,className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Rechercher un film, une s√©rie...",className:"w-full bg-transparent outline-none text-lg",value:O,onChange:r=>H(r.target.value),autoComplete:"off"})}),e.jsx("button",{onClick:()=>B(!1),className:"p-2 hover:bg-muted rounded-full",children:e.jsx(d.X,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"px-4 py-2 border-b bg-muted/10 flex items-center gap-4 text-sm flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d.Filter,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Filtres:"})]}),e.jsxs("select",{value:U,onChange:r=>$(r.target.value),className:"bg-background border rounded px-2 py-1 outline-none focus:ring-1 focus:ring-primary max-w-[200px]",children:[e.jsx("option",{value:"all",children:"Tous les indexeurs"}),t.map(r=>e.jsx("option",{value:r,children:r},r))]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none bg-muted/50 px-2 py-1 rounded hover:bg-muted transition-colors",children:[e.jsx("input",{type:"checkbox",checked:ee,onChange:r=>G(r.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{children:"üá´üá∑ FR / Multi"})]}),e.jsxs("div",{className:"flex-1 text-right text-muted-foreground text-xs",children:[L.length," / ",F.length," r√©sultat(s)"]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-0",children:se?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(d.Loader2,{className:"h-8 w-8 animate-spin mb-2"}),"Recherche en cours..."]}):L.length>0?e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-xs uppercase font-medium text-muted-foreground sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Titre"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Indexeur"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Taille"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:L.map(r=>e.jsxs("tr",{className:"hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:e.jsx("div",{className:"truncate max-w-[400px]",title:r.title,children:r.title})}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:r.indexer}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:me(r.size)}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:fe(r.publishDate)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>p(r),className:"inline-flex items-center gap-1 rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary hover:bg-primary/20 transition-colors",children:[e.jsx(d.Download,{className:"h-3 w-3"}),"DL"]})})]},r.guid))})]}):e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:O?F.length>0?"Aucun r√©sultat pour ces filtres.":"Aucun r√©sultat trouv√©":"Entrez un terme pour rechercher"})})]})})]})}function be(){const[n,o]=c.useState(!1),[x,u]=c.useState("http://localhost:9696"),[l,m]=c.useState(""),[w,j]=c.useState("idle"),[v,N]=c.useState(""),[h,y]=c.useState(!1);c.useEffect(()=>{(async()=>{const k=await window.electronAPI.getCredentials("prowlarr_url"),T=await window.electronAPI.getCredentials("prowlarr_apikey"),I=await window.electronAPI.getCredentials("prowlarr_configured");k&&u(k),T&&m(T),I==="true"&&y(!0)})()},[]);const R=async()=>{j("loading"),N("");try{let b=x.trim();!b.startsWith("http://")&&!b.startsWith("https://")&&(b=`http://${b}`),await S.testConnection(b,l)?(u(b),await window.electronAPI.saveCredentials("prowlarr_url",b),await window.electronAPI.saveCredentials("prowlarr_apikey",l),await window.electronAPI.saveCredentials("prowlarr_configured","true"),j("success"),N("Connexion r√©ussie et configuration sauvegard√©e"),y(!0)):(j("error"),N("√âchec de la connexion √† Prowlarr"),y(!1))}catch{j("error"),N("Erreur lors du test de connexion"),y(!1)}};return n?e.jsxs("div",{className:"rounded-lg border bg-card shadow-sm overflow-hidden transition-all",children:[e.jsxs("div",{onClick:()=>o(!1),className:"flex items-center justify-between p-4 border-b bg-muted/30 cursor-pointer hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(d.Database,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Prowlarr"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Indexeur de torrents"})]})]}),e.jsx(d.ChevronDown,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"URL de Prowlarr"}),e.jsx("input",{type:"text",value:x,onChange:b=>u(b.target.value),className:"w-full rounded-md border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"http://localhost:9696"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cl√© API"}),e.jsx("input",{type:"password",value:l,onChange:b=>m(b.target.value),className:"w-full rounded-md border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Votre cl√© API Prowlarr"})]}),v&&e.jsxs("div",{className:`flex items-center gap-2 rounded-md p-3 text-sm ${w==="success"?"bg-green-500/10 text-green-500":"bg-destructive/10 text-destructive"}`,children:[w==="success"?e.jsx(d.Check,{className:"h-4 w-4"}):e.jsx(d.AlertCircle,{className:"h-4 w-4"}),v]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{onClick:R,disabled:w==="loading",className:"flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[w==="loading"?e.jsx(d.Loader2,{className:"h-4 w-4 animate-spin"}):e.jsx(d.Save,{className:"h-4 w-4"}),"Tester & Sauvegarder"]})})]})]}):e.jsxs("div",{onClick:()=>o(!0),className:"flex items-center justify-between rounded-lg border bg-card p-4 shadow-sm hover:bg-accent/50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(d.Database,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Prowlarr"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configuration de l'indexeur Prowlarr"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[h?e.jsxs("div",{className:"flex items-center gap-2 text-green-500 text-sm font-medium",children:[e.jsx(d.Check,{className:"h-4 w-4"})," Configur√©"]}):e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:"Non configur√©"}),e.jsx(d.ChevronRight,{className:"h-5 w-5 text-muted-foreground"})]})]})}const ve={manifest:{id:"prowlarr",name:"Prowlarr",version:"1.0.0",description:"Gestionnaire d'indexeurs BitTorrent",author:"MG Tools Core",category:"indexer"},routes:[{path:"/prowlarr",element:e.jsx(je,{})}],sidebarItems:[{id:"prowlarr",label:"Prowlarr",icon:d.Search,path:"/prowlarr",order:2}],settings:be,services:[{id:"prowlarr",implementation:S}]};A.ProwlarrPlugin=ve,Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})}));
