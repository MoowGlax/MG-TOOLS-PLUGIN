(function(i,c){typeof exports=="object"&&typeof module<"u"?module.exports=c(require("lucide-react"),require("react"),require("react-router-dom"),require("sonner")):typeof define=="function"&&define.amd?define(["lucide-react","react","react-router-dom","sonner"],c):(i=typeof globalThis<"u"?globalThis:i||self,i.prowlarr=c(i.LucideReact,i.React,i.ReactRouterDOM,i.Sonner))})(this,(function(i,c,B,C){"use strict";var M={exports:{}},k={};var J;function le(){if(J)return k;J=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function a(n,l,o){var u=null;if(o!==void 0&&(u=""+o),l.key!==void 0&&(u=""+l.key),"key"in l){o={};for(var x in l)x!=="key"&&(o[x]=l[x])}else o=l;return l=o.ref,{$$typeof:r,type:n,key:u,ref:l!==void 0?l:null,props:o}}return k.Fragment=t,k.jsx=a,k.jsxs=a,k}var K;function ie(){return K||(K=1,M.exports=le()),M.exports}var e=ie();let N="",b="";const V=3600*1e3,$=new Map,G=r=>{const t=$.get(r);return t&&Date.now()-t.timestamp<V?t.data:null},W=(r,t)=>{$.set(r,{data:t,timestamp:Date.now()})},v={init:async()=>{const r=await window.electronAPI.getCredentials("prowlarr_url"),t=await window.electronAPI.getCredentials("prowlarr_apikey");N=r||"",b=t||""},testConnection:async(r,t)=>{try{return(await window.electronAPI.proxyRequest(`${r}/api/v1/health`,{headers:{"X-Api-Key":t}})).ok}catch(a){return console.error("Prowlarr connection test failed",a),!1}},getNextUpdate:()=>{let r=0;for(const t of $.values())t.timestamp>r&&(r=t.timestamp);return r>0?r+V:null},checkHealth:async()=>{try{if(await v.init(),!N||!b)return!1;const r=N.replace(/\/$/,"");return(await window.electronAPI.proxyRequest(`${r}/api/v1/health`,{headers:{"X-Api-Key":b}})).ok}catch{return!1}},getStats:async(r=!1)=>{if(await v.init(),!N||!b)return{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0};const t=N.replace(/\/$/,""),a=`stats-${t}`;if(!r){const n=G(a);if(n)return n}try{const n=await window.electronAPI.proxyRequest(`${t}/api/v1/indexer`,{headers:{"X-Api-Key":b,Accept:"application/json"}});if(n.ok&&Array.isArray(n.data)){const l=n.data,o={indexerCount:l.length,enabledIndexerCount:l.filter(u=>u.enable).length,latestReleaseCount:0};return W(a,o),o}return{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0}}catch(n){return console.error("Failed to get Prowlarr stats",n),{indexerCount:0,enabledIndexerCount:0,latestReleaseCount:0}}},search:async(r="",t=!1)=>{if(await v.init(),!N||!b)return console.warn("Prowlarr credentials missing",{currentUrl:N,hasKey:!!b}),[];const a=N.replace(/\/$/,""),n=`search-${r}-${a}`;if(!t){const l=G(n);if(l)return l}try{const l=encodeURIComponent(r),o=`${a}/api/v1/search?query=${l}&type=search&limit=100&offset=0&apikey=${b}`;console.log("Fetching Prowlarr (Direct URL):",o);const u=await window.electronAPI.proxyRequest(o,{method:"GET",headers:{"X-Api-Key":b,Accept:"application/json"},timeout:6e4});if(console.log("Prowlarr Raw Response:",u),!u||!u.ok)return console.error("Prowlarr API Error - Not OK:",u),[];let x=[];const m=u.data;if(Array.isArray(m))x=m;else if(m&&typeof m=="object")if("records"in m&&Array.isArray(m.records))x=m.records;else{const h=Object.values(m).find(j=>Array.isArray(j));h?x=h:x=Object.values(m).filter(j=>j&&j.guid)}console.log(`Parsed ${x.length} results`);const y=x.map(h=>({guid:h.guid,indexerId:h.indexerId,indexer:h.indexer,title:h.title,publishDate:h.publishDate||h.added||new Date().toISOString(),size:h.size,downloadUrl:h.downloadUrl,magnetUrl:h.magnetUrl,protocol:h.protocol,seeders:h.seeders,leechers:h.leechers}));return W(n,y),y}catch(l){return console.error("Prowlarr search failed",l),[]}},getPublicUrl:async()=>(N||await v.init(),N)};let I=null,P=null,ce=1;const H=()=>ce++,w={login:async(r,t)=>{try{console.log(`Connecting to Deluge at ${r}`),P=r;const a={method:"auth.login",params:[t],id:H()},n=await window.electronAPI.proxyRequest(`${r}/json`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(a)}),l=n.data;if(n.ok&&l&&!l.error&&l.result){if(n.headers){const o=n.headers["set-cookie"]||n.headers["Set-Cookie"];o&&(I=o.split(";")[0])}return!0}return!1}catch(a){return console.error("Deluge login error:",a),!1}},checkConnection:async()=>{if(!I){const r=await window.electronAPI.getCredentials("deluge_url"),t=await window.electronAPI.getCredentials("deluge_password");return r&&t?w.login(r,t):!1}return!0},invoke:async(r,t=[])=>{if(!P){const u=await window.electronAPI.getCredentials("deluge_url");if(u)P=u;else throw new Error("Deluge not configured")}I||await w.checkConnection();const a={method:r,params:t,id:H()},n={"Content-Type":"application/json",Accept:"application/json"};I&&(n.Cookie=I);const o=(await window.electronAPI.proxyRequest(`${P}/json`,{method:"POST",headers:n,body:JSON.stringify(a)})).data;if(o&&o.error)throw new Error(o.error.message||"RPC Error");return o?.result},getStats:async()=>{try{const r=await w.getTorrents();let t=0,a=0,n=0,l=0;return r.forEach(o=>{t+=o.download_payload_rate,a+=o.upload_payload_rate,o.state==="Paused"?l++:n++}),{downloadSpeed:Math.floor(t/1024),uploadSpeed:Math.floor(a/1024),activeTorrents:n,pausedTorrents:l}}catch(r){return console.error(r),{downloadSpeed:0,uploadSpeed:0,activeTorrents:0,pausedTorrents:0}}},getTorrents:async()=>{try{const r=["name","total_size","state","progress","download_payload_rate","upload_payload_rate","eta","save_path"],t=await w.invoke("web.update_ui",[r,{}]);return t&&t.torrents?Object.entries(t.torrents).map(([a,n])=>({id:a,name:n.name,total_size:n.total_size,state:n.state,progress:n.progress,download_payload_rate:n.download_payload_rate,upload_payload_rate:n.upload_payload_rate,eta:n.eta,save_path:n.save_path})):[]}catch(r){return console.error("Error fetching torrents:",r),[]}},addMagnet:async r=>{try{if(!P)throw new Error("Not connected");return await w.invoke("core.add_torrent_magnet",[r,{}]),!0}catch(t){return console.error("Failed to add magnet",t),!1}},addTorrentFile:async(r,t)=>{try{if(!P)throw new Error("Not connected");return await w.invoke("core.add_torrent_file",[r,t,{}]),!0}catch(a){return console.error("Failed to add torrent file",a),!1}},removeTorrent:async(r,t=!1)=>{try{return await w.invoke("core.remove_torrent",[r,t]),!0}catch(a){return console.error(a),!1}},pauseTorrent:async r=>{try{return await w.invoke("core.pause_torrent",[[r]]),!0}catch{return!1}},resumeTorrent:async r=>{try{return await w.invoke("core.resume_torrent",[[r]]),!0}catch{return!1}},checkHealth:async()=>{try{return await w.checkConnection()}catch{return!1}}};class de{plugins=new Map;services=new Map;loaded=!1;async initialize(){if(!this.loaded)try{const t=await window.electronAPI.getPlugins();console.log("Found plugins:",t);for(const a of t)try{const n=await window.electronAPI.loadPlugin(a);n&&this.loadPluginFromCode(n)}catch(n){console.error(`Failed to load plugin ${a}:`,n)}}catch(t){console.error("Failed to initialize plugins:",t)}finally{this.loaded=!0}}loadPluginFromCode(t){try{const a={},n={exports:a},l={react:window.React,"react-dom":window.ReactDOM,"react-router-dom":window.ReactRouterDOM,"lucide-react":window.LucideReact,sonner:window.Sonner},o=m=>l[m]||console.warn(`Missing dependency: ${m}`),u={env:{NODE_ENV:"production"}};new Function("module","exports","require","process","React","ReactDOM","ReactRouterDOM","LucideReact","Sonner",t)(n,a,o,u,window.React,window.ReactDOM,window.ReactRouterDOM,window.LucideReact,window.Sonner);const x=n.exports.default||n.exports;x&&x.manifest&&this.register(x)}catch(a){console.error("Error executing plugin code:",a)}}register(t){console.log(`Registering plugin: ${t.manifest.id}`),this.plugins.set(t.manifest.id,t),t.services&&t.services.forEach(a=>{this.services.set(a.id,a.implementation)})}getPlugin(t){return this.plugins.get(t)}getAllPlugins(){return Array.from(this.plugins.values())}getService(t){return this.services.get(t)}}const ue=new de;window.PluginManager=ue;const xe=c.createContext(void 0);function pe(){const r=c.useContext(xe);if(r===void 0)throw new Error("useApp must be used within an AppProvider");return r}function X(r,t=2){if(!+r)return"0 Bytes";const a=1024,n=t<0?0:t,l=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],o=Math.floor(Math.log(r)/Math.log(a));return`${parseFloat((r/Math.pow(a,o)).toFixed(n))} ${l[o]}`}function Q(r){const t=new Date(r);return new Intl.DateTimeFormat("fr-FR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}).format(t)}const he=r=>{const t=r.toUpperCase();return/\b(FRENCH|TRUEFRENCH|VFF|VF|VOSTFR|MULTI)\b/.test(t)};function me(){const{notify:r}=pe(),t=B.useNavigate(),a=B.useLocation(),[n,l]=c.useState(null),[o,u]=c.useState([]),[x,m]=c.useState(null),[y,h]=c.useState(!1),[j,E]=c.useState(""),[f,_]=c.useState(null),[D,A]=c.useState(""),[ge,U]=c.useState(!1),[F,Y]=c.useState(""),[R,Z]=c.useState([]),[we,T]=c.useState(!1);c.useEffect(()=>{(async()=>{const p=a.state;if(p?.search){const d=p.search;Y(d),U(!0),T(!0);try{const g=await v.search(d,!0);Z(g)}catch(g){console.error("Auto search failed",g)}finally{T(!1)}}})()},[]);const[ee,ye]=c.useState("all"),[te,je]=c.useState(!1),[re,ve]=c.useState("all"),[se,Ne]=c.useState(!1),ne=(s,p,d)=>s.filter(g=>!(p!=="all"&&g.indexer!==p||d&&!he(g.title))),O=ne(o,ee,te),q=ne(R,re,se),ae=s=>Array.from(new Set(s.map(p=>p.indexer))).sort(),be=ae(o),Ce=ae(R);c.useEffect(()=>{const s=setInterval(()=>{if(!f){A("");return}const p=Date.now(),d=f-p;if(d<=0){A("Mise √† jour..."),L(!0,!0);return}if(d>36e5){const g=Math.floor(d/36e5),S=Math.floor(d%36e5/6e4);A(`${g}h ${S}m`)}else{const g=Math.floor(d/6e4),S=Math.floor(d%6e4/1e3);A(`${g}m ${S}s`)}},1e3);return()=>clearInterval(s)},[f]),c.useEffect(()=>{(async()=>{const p=await window.electronAPI.getCredentials("prowlarr_configured"),d=await window.electronAPI.getCredentials("prowlarr_url");d&&E(d),p?(m(!0),L()):(m(!1),setTimeout(()=>{t("/settings",{state:{section:"prowlarr"}})},2e3))})()},[t]);const L=async(s=!1,p=!1)=>{h(!0);try{const d=await v.getStats(s);l(d);const g=await v.search("",s);u(g);const S=v.getNextUpdate();_(S),p&&s&&r("Prowlarr",{body:"Actualisation termin√©e",type:"success"})}catch(d){console.error("Failed to load Prowlarr data",d)}finally{h(!1)}},Se=async s=>{if(s&&(s.preventDefault(),s.stopPropagation()),!!F.trim()){T(!0);try{const p=await v.search(F,!0);Z(p)}catch(p){console.error("Search failed",p)}finally{T(!1)}}},oe=async s=>{const p=s.magnetUrl||s.downloadUrl;if(!p){C.toast.error("Lien de t√©l√©chargement introuvable");return}const d=C.toast.loading(`Ajout de "${s.title}"...`);if(p.startsWith("magnet:"))await w.addMagnet(p)?C.toast.success(`"${s.title}" ajout√© avec succ√®s`,{id:d}):C.toast.error("√âchec de l'ajout √† Deluge",{id:d,description:"V√©rifiez que Deluge est connect√©"});else try{const S=await(await fetch(p)).blob(),z=new FileReader;z.onload=async()=>{const Ae=z.result.split(",")[1];await w.addTorrentFile(`${s.title}.torrent`,Ae)?C.toast.success(`"${s.title}" ajout√© avec succ√®s`,{id:d}):C.toast.error("√âchec de l'ajout √† Deluge",{id:d})},z.readAsDataURL(S)}catch(g){console.error(g),C.toast.error("Impossible de t√©l√©charger le fichier torrent",{id:d,description:"Le lien Magnet n'est pas disponible."})}},Pe=()=>{j&&window.open(j,"_blank")};return x===!1?e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(i.AlertCircle,{className:"mx-auto h-12 w-12 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Module non configur√©"}),e.jsx("p",{className:"text-muted-foreground",children:"Redirection vers les param√®tres..."})]})]})}):x===null?e.jsx("div",{children:"Chargement..."}):e.jsxs("div",{className:"space-y-6 h-full flex flex-col relative",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(i.Database,{className:"h-6 w-6"}),"Prowlarr"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>U(!0),className:"flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90",children:[e.jsx(i.Search,{className:"h-4 w-4"})," Rechercher"]}),e.jsxs("button",{onClick:Pe,className:"flex items-center gap-2 rounded-md border px-4 py-2 text-sm font-medium hover:bg-muted",children:[e.jsx(i.ExternalLink,{className:"h-4 w-4"})," Interface Web"]})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(i.Globe,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Indexeurs Totaux"}),e.jsx("div",{className:"text-2xl font-bold",children:n.indexerCount})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-green-500/10 rounded-full",children:e.jsx(i.Wifi,{className:"h-6 w-6 text-green-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Actifs"}),e.jsx("div",{className:"text-2xl font-bold",children:n.enabledIndexerCount})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border bg-card text-card-foreground shadow-sm flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-full",children:e.jsx(i.Calendar,{className:"h-6 w-6 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Derni√®res Sorties"}),e.jsx("div",{className:"text-2xl font-bold",children:o.length})]})]})]}),e.jsxs("div",{className:"flex-1 rounded-lg border bg-card text-card-foreground shadow-sm overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b bg-muted/30 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"font-semibold flex items-center gap-2",children:[e.jsx(i.Calendar,{className:"h-5 w-5 text-muted-foreground"}),"Derni√®res sorties"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[D&&e.jsxs("span",{className:"text-xs text-muted-foreground font-mono bg-muted px-2 py-1 rounded",children:["Prochaine maj: ",D]}),e.jsx("button",{onClick:()=>L(!0),disabled:y,className:"p-1 hover:bg-muted rounded-full transition-colors",title:"Actualiser",children:e.jsx(i.RefreshCw,{className:`h-4 w-4 ${y?"animate-spin":""}`})})]})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i.Filter,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Filtres:"})]}),e.jsxs("select",{value:ee,onChange:s=>ye(s.target.value),className:"bg-background border rounded px-2 py-1 outline-none focus:ring-1 focus:ring-primary max-w-[200px]",children:[e.jsx("option",{value:"all",children:"Tous les indexeurs"}),be.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none bg-muted/50 px-2 py-1 rounded hover:bg-muted transition-colors",children:[e.jsx("input",{type:"checkbox",checked:te,onChange:s=>je(s.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{children:"üá´üá∑ FR / Multi"})]}),e.jsxs("div",{className:"flex-1 text-right text-muted-foreground text-xs",children:[O.length," / ",o.length," r√©sultat(s)"]})]})]}),e.jsx("div",{className:"overflow-x-auto flex-1",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-xs uppercase font-medium text-muted-foreground sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Titre"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Indexeur"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Taille"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),e.jsxs("tbody",{className:"divide-y",children:[O.map(s=>e.jsxs("tr",{className:"hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:e.jsx("div",{className:"truncate max-w-[300px]",title:s.title,children:s.title})}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:s.indexer}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:X(s.size)}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:Q(s.publishDate)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>oe(s),className:"inline-flex items-center gap-1 rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary hover:bg-primary/20 transition-colors",title:"T√©l√©charger avec Deluge",children:[e.jsx(i.Download,{className:"h-3 w-3"}),"DL"]})})]},s.guid)),O.length===0&&!y&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-muted-foreground",children:o.length===0?"Aucune sortie r√©cente trouv√©e. V√©rifiez vos indexeurs.":"Aucun r√©sultat pour ces filtres."})}),y&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-muted-foreground",children:"Chargement..."})})]})]})})]}),ge&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border shadow-lg rounded-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b flex items-center gap-4",children:[e.jsx(i.Search,{className:"h-5 w-5 text-muted-foreground"}),e.jsx("form",{onSubmit:Se,className:"flex-1",children:e.jsx("input",{type:"text",placeholder:"Rechercher un film, une s√©rie...",className:"w-full bg-transparent outline-none text-lg",value:F,onChange:s=>Y(s.target.value),autoComplete:"off"})}),e.jsx("button",{onClick:()=>U(!1),className:"p-2 hover:bg-muted rounded-full",children:e.jsx(i.X,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"px-4 py-2 border-b bg-muted/10 flex items-center gap-4 text-sm flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(i.Filter,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Filtres:"})]}),e.jsxs("select",{value:re,onChange:s=>ve(s.target.value),className:"bg-background border rounded px-2 py-1 outline-none focus:ring-1 focus:ring-primary max-w-[200px]",children:[e.jsx("option",{value:"all",children:"Tous les indexeurs"}),Ce.map(s=>e.jsx("option",{value:s,children:s},s))]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer select-none bg-muted/50 px-2 py-1 rounded hover:bg-muted transition-colors",children:[e.jsx("input",{type:"checkbox",checked:se,onChange:s=>Ne(s.target.checked),className:"rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{children:"üá´üá∑ FR / Multi"})]}),e.jsxs("div",{className:"flex-1 text-right text-muted-foreground text-xs",children:[q.length," / ",R.length," r√©sultat(s)"]})]}),e.jsx("div",{className:"flex-1 overflow-auto p-0",children:we?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(i.Loader2,{className:"h-8 w-8 animate-spin mb-2"}),"Recherche en cours..."]}):q.length>0?e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-xs uppercase font-medium text-muted-foreground sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Titre"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Indexeur"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Taille"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Date"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y",children:q.map(s=>e.jsxs("tr",{className:"hover:bg-muted/50 transition-colors",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:e.jsx("div",{className:"truncate max-w-[400px]",title:s.title,children:s.title})}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:s.indexer}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:X(s.size)}),e.jsx("td",{className:"px-4 py-3 text-muted-foreground",children:Q(s.publishDate)}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsxs("button",{onClick:()=>oe(s),className:"inline-flex items-center gap-1 rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary hover:bg-primary/20 transition-colors",children:[e.jsx(i.Download,{className:"h-3 w-3"}),"DL"]})})]},s.guid))})]}):e.jsx("div",{className:"py-12 text-center text-muted-foreground",children:F?R.length>0?"Aucun r√©sultat pour ces filtres.":"Aucun r√©sultat trouv√©":"Entrez un terme pour rechercher"})})]})})]})}function fe(){const[r,t]=c.useState(!1),[a,n]=c.useState("http://localhost:9696"),[l,o]=c.useState(""),[u,x]=c.useState("idle"),[m,y]=c.useState(""),[h,j]=c.useState(!1);c.useEffect(()=>{(async()=>{const _=await window.electronAPI.getCredentials("prowlarr_url"),D=await window.electronAPI.getCredentials("prowlarr_apikey"),A=await window.electronAPI.getCredentials("prowlarr_configured");_&&n(_),D&&o(D),A==="true"&&j(!0)})()},[]);const E=async()=>{x("loading"),y("");try{let f=a.trim();!f.startsWith("http://")&&!f.startsWith("https://")&&(f=`http://${f}`),await v.testConnection(f,l)?(n(f),await window.electronAPI.saveCredentials("prowlarr_url",f),await window.electronAPI.saveCredentials("prowlarr_apikey",l),await window.electronAPI.saveCredentials("prowlarr_configured","true"),x("success"),y("Connexion r√©ussie et configuration sauvegard√©e"),j(!0)):(x("error"),y("√âchec de la connexion √† Prowlarr"),j(!1))}catch{x("error"),y("Erreur lors du test de connexion"),j(!1)}};return r?e.jsxs("div",{className:"rounded-lg border bg-card shadow-sm overflow-hidden transition-all",children:[e.jsxs("div",{onClick:()=>t(!1),className:"flex items-center justify-between p-4 border-b bg-muted/30 cursor-pointer hover:bg-muted/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(i.Database,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Prowlarr"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Indexeur de torrents"})]})]}),e.jsx(i.ChevronDown,{className:"h-5 w-5 text-muted-foreground"})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"URL de Prowlarr"}),e.jsx("input",{type:"text",value:a,onChange:f=>n(f.target.value),className:"w-full rounded-md border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"http://localhost:9696"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Cl√© API"}),e.jsx("input",{type:"password",value:l,onChange:f=>o(f.target.value),className:"w-full rounded-md border bg-background px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Votre cl√© API Prowlarr"})]}),m&&e.jsxs("div",{className:`flex items-center gap-2 rounded-md p-3 text-sm ${u==="success"?"bg-green-500/10 text-green-500":"bg-destructive/10 text-destructive"}`,children:[u==="success"?e.jsx(i.Check,{className:"h-4 w-4"}):e.jsx(i.AlertCircle,{className:"h-4 w-4"}),m]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsxs("button",{onClick:E,disabled:u==="loading",className:"flex items-center gap-2 rounded-md bg-primary px-4 py-2 text-sm font-medium text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[u==="loading"?e.jsx(i.Loader2,{className:"h-4 w-4 animate-spin"}):e.jsx(i.Save,{className:"h-4 w-4"}),"Tester & Sauvegarder"]})})]})]}):e.jsxs("div",{onClick:()=>t(!0),className:"flex items-center justify-between rounded-lg border bg-card p-4 shadow-sm hover:bg-accent/50 cursor-pointer transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:e.jsx(i.Database,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Prowlarr"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configuration de l'indexeur Prowlarr"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[h?e.jsxs("div",{className:"flex items-center gap-2 text-green-500 text-sm font-medium",children:[e.jsx(i.Check,{className:"h-4 w-4"})," Configur√©"]}):e.jsx("div",{className:"flex items-center gap-2 text-muted-foreground text-sm",children:"Non configur√©"}),e.jsx(i.ChevronRight,{className:"h-5 w-5 text-muted-foreground"})]})]})}return{manifest:{id:"prowlarr",name:"Prowlarr",version:"1.0.0",description:"Gestionnaire d'indexeurs BitTorrent",author:"MG Tools Core",category:"indexer"},routes:[{path:"/prowlarr",element:e.jsx(me,{})}],sidebarItems:[{id:"prowlarr",label:"Prowlarr",icon:i.Search,path:"/prowlarr",order:2}],settings:fe,services:[{id:"prowlarr",implementation:v}]}}));
